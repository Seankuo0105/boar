<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±±è±¬å–®å­—å¤§äº‚é¬¥ ğŸ—</title>
    <style>
        :root {
            --primary: #5D4037;
            --secondary: #8D6E63;
            --accent: #FF7043;
            --bg: #EFEBE9;
            --text: #3E2723;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            user-select: none;
        }

        h1 {
            color: var(--primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: transform 0.1s, background-color 0.2s;
        }

        button:active {
            transform: scale(0.95);
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .refresh-btn {
            background-color: var(--accent);
        }

        .game-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            max-width: 1200px;
            width: 100%;
        }

        .column {
            flex: 1;
            min-width: 300px;
            background: #fff;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .column-title {
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .draggable {
            background-color: white;
            border: 2px solid var(--primary);
            padding: 10px;
            border-radius: 8px;
            cursor: grab;
            text-align: center;
            font-weight: bold;
            position: relative;
            touch-action: none;
            transition: transform 0.2s, box-shadow 0.2s;
            z-index: 10;
        }

        .draggable:active {
            cursor: grabbing;
            transform: scale(1.05);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .draggable.matched {
            background-color: #C8E6C9;
            border-color: #2E7D32;
            color: #1B5E20;
            cursor: default;
        }

        .drop-zone {
            background-color: #D7CCC8;
            border: 2px dashed var(--secondary);
            min-height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            transition: background-color 0.2s;
            position: relative;
        }

        .drop-zone.hover {
            background-color: #FFCCBC;
            border-style: solid;
        }

        .meaning-text {
            flex: 1;
            margin-right: 10px;
            font-size: 0.95rem;
        }

        .placeholder {
            width: 120px;
            height: 35px;
            background-color: rgba(255,255,255,0.5);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-size: 0.8rem;
        }

        #page-indicator {
            font-weight: bold;
            color: var(--primary);
            min-width: 80px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .game-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

    <h1>ğŸ— å±±è±¬å–®å­—å¤§äº‚é¬¥ ğŸ—</h1>
    
    <div class="controls">
        <button id="prevBtn" onclick="changePage(-1)">ä¸Šä¸€é </button>
        <span id="page-indicator">ç¬¬ 1 é </span>
        <button id="nextBtn" onclick="changePage(1)">ä¸‹ä¸€é </button>
        <button class="refresh-btn" onclick="initGame()">ğŸ”„ å…¨éƒ¨é‡æ´—</button>
    </div>

    <div class="game-container">
        <div class="column" id="target-list">
            <div class="column-title">æŠŠè‹±æ–‡æ‹–åˆ°é€™è£¡ ğŸ—</div>
        </div>

        <div class="column" id="source-list">
            <div class="column-title">è‹±æ–‡å–®å­—åº«</div>
        </div>
    </div>

<script>
    // ğŸ— å®Œæ•´å–®å­—åº« (å…± 89 å€‹) ğŸ—
    const rawData = [
        // Page 1
        { en: "trainee", ch: "å¯¦ç¿’ç”Ÿ" }, { en: "enthusiastic", ch: "ç†±æƒ…çš„" }, { en: "introduce", ch: "ä»‹ç´¹" },
        { en: "cultural", ch: "æ–‡åŒ–çš„" }, { en: "impressed", ch: "å°è±¡æ·±åˆ»çš„" }, { en: "migrant", ch: "ç§»å±…çš„" },
        { en: "worker", ch: "å·¥äºº" }, { en: "labor", ch: "å‹å‹•" }, { en: "nursing home", ch: "å®‰é¤Šé™¢" },
        { en: "treat", ch: "å°å¾…/è«‹å®¢" }, { en: "abroad", ch: "åœ¨åœ‹å¤–" }, { en: "celebrate", ch: "æ…¶ç¥" },
        { en: "create", ch: "å‰µé€ " }, { en: "issue", ch: "ç™¼è¡Œ/è­°é¡Œ" }, { en: "hero", ch: "è‹±é›„" },
        { en: "happiness", ch: "å¹¸ç¦" }, { en: "reduce", ch: "æ¸›å°‘" }, { en: "infection", ch: "æ„ŸæŸ“" },
        { en: "germ", ch: "ç´°èŒ" }, { en: "rinse", ch: "æ²–æ´—" }, { en: "correctly", ch: "æ­£ç¢ºåœ°" },
        { en: "plastic", ch: "å¡‘è† " }, { en: "fragile", ch: "æ˜“ç¢çš„" }, { en: "environmental", ch: "ç’°å¢ƒçš„" },
        { en: "ban", ch: "ç¦æ­¢" }, { en: "habit", ch: "ç¿’æ…£" }, { en: "opossum", ch: "è² é¼ " },
        { en: "climb", ch: "æ”€çˆ¬" }, { en: "pretend", ch: "å‡è£" }, { en: "pouch", ch: "è‚²å…’è¢‹" },
        // Page 2
        { en: "festival", ch: "ç¯€æ—¥" }, { en: "greasy", ch: "æ²¹è†©çš„" }, { en: "throw", ch: "ä¸Ÿ/æŠ•æ“²" },
        { en: "parade", ch: "éŠè¡Œ" }, { en: "smash", ch: "ç²‰ç¢/çŒ›æ’" }, { en: "difference", ch: "å·®ç•°" },
        { en: "uniform", ch: "åˆ¶æœ" }, { en: "homestay", ch: "å¯„å®¿å®¶åº­" }, { en: "karaoke", ch: "å¡æ‹‰OK" },
        { en: "surely", ch: "æƒ³å¿…/è‚¯å®š" }, { en: "pop-up", ch: "å¿«é–ƒçš„" }, { en: "interact", ch: "äº’å‹•" },
        { en: "touch", ch: "è§¸æ‘¸" }, { en: "temporary", ch: "æš«æ™‚çš„" }, { en: "popular", ch: "å—æ­¡è¿çš„" },
        { en: "field trip", ch: "æ ¡å¤–æ•™å­¸" }, { en: "exhibit", ch: "å±•è¦½" }, { en: "permanent", ch: "æ°¸ä¹…çš„" },
        { en: "fossil", ch: "åŒ–çŸ³" }, { en: "experience", ch: "ç¶“é©—" }, { en: "hike", ch: "å¥è¡Œ" },
        { en: "trail", ch: "æ­¥é“" }, { en: "energy", ch: "èƒ½æº/ç²¾åŠ›" }, { en: "wild", ch: "é‡ç”Ÿçš„" },
        { en: "trip over", ch: "çµ†å€’" }, { en: "camping", ch: "éœ²ç‡Ÿ" }, { en: "tent", ch: "å¸³ç¯·" },
        { en: "cooler", ch: "å†°æ¡¶" }, { en: "forecast", ch: "é å ±" }, { en: "beforehand", ch: "äº‹å…ˆ" },
        // Page 3
        { en: "shelter", ch: "é¿é›£æ‰€" }, { en: "steady", ch: "ç©©å›ºçš„" }, { en: "shaking", ch: "æ–æ™ƒ" },
        { en: "utility pole", ch: "é›»ç·šæ¡¿" }, { en: "emergency kit", ch: "æ€¥æ•‘åŒ…" }, { en: "unexpected", ch: "å‡ºä¹æ„æ–™çš„" },
        { en: "seriously", ch: "èªçœŸåœ°" }, { en: "flashlight", ch: "æ‰‹é›»ç­’" }, { en: "whistle", ch: "å“¨å­" },
        { en: "bushfire", ch: "å¢æ—å¤§ç«" }, { en: "spread", ch: "è”“å»¶" }, { en: "condition", ch: "ç‹€æ³" },
        { en: "disappear", ch: "æ¶ˆå¤±" }, { en: "affect", ch: "å½±éŸ¿" }, { en: "tester", ch: "æ¸¬è©¦å“¡" },
        { en: "requirement", ch: "è¦æ±‚" }, { en: "sample", ch: "æ¨£æœ¬" }, { en: "quality", ch: "å“è³ª" },
        { en: "patience", ch: "è€å¿ƒ" }, { en: "stereotype", ch: "åˆ»æ¿å°è±¡" }, { en: "actually", ch: "äº‹å¯¦ä¸Š" },
        { en: "favorite", ch: "æœ€å–œæ„›çš„" }, { en: "upload", ch: "ä¸Šå‚³" }, { en: "subscriber", ch: "è¨‚é–±è€…" },
        { en: "interest", ch: "èˆˆè¶£" }, { en: "dream", ch: "å¤¢æƒ³" }, { en: "excellent", ch: "å„ªç§€çš„" },
        { en: "chance", ch: "æ©Ÿæœƒ" }, { en: "proud", ch: "é©•å‚²çš„" }
    ];

    const ITEMS_PER_PAGE = 10;
    let pagesData = [];
    let currentPage = 0;
    let draggedItem = null;
    let touchClone = null;

    // æ´—ç‰Œæ¼”ç®—æ³• (Fisher-Yates)
    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    // åˆå§‹åŒ–éŠæˆ²ï¼šæ´—ç‰Œä¸¦åˆ†é 
    function initGame() {
        const shuffled = shuffle([...rawData]); // è¤‡è£½ä¸€ä»½å†æ´—ç‰Œï¼Œä¸å½±éŸ¿åŸå§‹è³‡æ–™
        pagesData = [];
        
        for (let i = 0; i < shuffled.length; i += ITEMS_PER_PAGE) {
            pagesData.push(shuffled.slice(i, i + ITEMS_PER_PAGE));
        }

        currentPage = 0;
        renderPage();
    }

    function changePage(delta) {
        const newPage = currentPage + delta;
        if (newPage >= 0 && newPage < pagesData.length) {
            currentPage = newPage;
            renderPage();
        }
    }

    function renderPage() {
        // æ›´æ–°æŒ‰éˆ•èˆ‡é ç¢¼
        document.getElementById('prevBtn').disabled = (currentPage === 0);
        document.getElementById('nextBtn').disabled = (currentPage === pagesData.length - 1);
        document.getElementById('page-indicator').textContent = `ç¬¬ ${currentPage + 1} / ${pagesData.length} é `;

        const targetList = document.getElementById('target-list');
        const sourceList = document.getElementById('source-list');
        
        targetList.innerHTML = '<div class="column-title">æŠŠè‹±æ–‡æ‹–åˆ°é€™è£¡ ğŸ—</div>';
        sourceList.innerHTML = '<div class="column-title">è‹±æ–‡å–®å­—åº«</div>';

        const currentData = pagesData[currentPage];

        // 1. å»ºç«‹ç›®æ¨™å€ (å·¦é‚Š)
        currentData.forEach(item => {
            const dropZone = document.createElement('div');
            dropZone.className = 'drop-zone';
            dropZone.dataset.answer = item.en;
            
            dropZone.innerHTML = `
                <span class="meaning-text">ğŸ— ${item.ch}</span>
                <div class="placeholder">æ‹–æ›³è‡³æ­¤</div>
            `;
            targetList.appendChild(dropZone);
        });

        // 2. å»ºç«‹ä¾†æºå€ (å³é‚Š) - å†æ¬¡æ‰“äº‚å–®å­—é †åºï¼Œé¿å…ç›´æ¥å°æ‡‰
        const shuffledWords = shuffle([...currentData]);
        
        shuffledWords.forEach(item => {
            const dragItem = document.createElement('div');
            dragItem.className = 'draggable';
            dragItem.textContent = item.en;
            dragItem.draggable = true;
            
            addDragEvents(dragItem);
            sourceList.appendChild(dragItem);
        });

        // ç¶å®šæ”¾ç½®å€äº‹ä»¶
        document.querySelectorAll('.drop-zone').forEach(zone => {
            addDropEvents(zone);
        });
    }

    // --- æ‹–æ›³é‚è¼¯ (æ»‘é¼ ) ---
    function addDragEvents(el) {
        el.addEventListener('dragstart', function(e) {
            draggedItem = this;
            e.dataTransfer.effectAllowed = 'move';
            this.style.opacity = '0.4';
        });

        el.addEventListener('dragend', function() {
            this.style.opacity = '1';
            draggedItem = null;
        });

        // æ‰‹æ©Ÿè§¸æ§æ”¯æ´
        el.addEventListener('touchstart', handleTouchStart, {passive: false});
        el.addEventListener('touchmove', handleTouchMove, {passive: false});
        el.addEventListener('touchend', handleTouchEnd);
    }

    function addDropEvents(zone) {
        zone.addEventListener('dragover', function(e) {
            e.preventDefault();
            if (!this.querySelector('.draggable')) {
                this.classList.add('hover');
            }
        });

        zone.addEventListener('dragleave', function() {
            this.classList.remove('hover');
        });

        zone.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('hover');
            if (draggedItem) {
                checkMatch(this, draggedItem);
            }
        });
    }

    // --- è§¸æ§é‚è¼¯ (æ‰‹æ©Ÿç‰ˆä¿®å¾©) ---
    function handleTouchStart(e) {
        e.preventDefault();
        draggedItem = this;
        
        touchClone = this.cloneNode(true);
        touchClone.style.position = 'fixed';
        touchClone.style.zIndex = '9999';
        touchClone.style.pointerEvents = 'none';
        touchClone.style.opacity = '0.8';
        touchClone.style.width = this.offsetWidth + 'px';
        document.body.appendChild(touchClone);

        const touch = e.touches[0];
        moveClone(touch.clientX, touch.clientY);
    }

    function handleTouchMove(e) {
        e.preventDefault();
        const touch = e.touches[0];
        moveClone(touch.clientX, touch.clientY);

        const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
        const dropZone = elemBelow ? elemBelow.closest('.drop-zone') : null;

        document.querySelectorAll('.drop-zone').forEach(z => z.classList.remove('hover'));
        if (dropZone && !dropZone.querySelector('.draggable')) {
            dropZone.classList.add('hover');
        }
    }

    function handleTouchEnd(e) {
        const touch = e.changedTouches[0];
        if (touchClone) {
            touchClone.remove();
            touchClone = null;
        }
        
        document.querySelectorAll('.drop-zone').forEach(z => z.classList.remove('hover'));
        const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
        const dropZone = elemBelow ? elemBelow.closest('.drop-zone') : null;

        if (dropZone) {
            checkMatch(dropZone, draggedItem);
        }
        
        draggedItem = null;
    }

    function moveClone(x, y) {
        if (touchClone) {
            touchClone.style.left = (x - touchClone.offsetWidth / 2) + 'px';
            touchClone.style.top = (y - touchClone.offsetHeight / 2) + 'px';
        }
    }

    // --- é…å°æª¢æŸ¥ ---
    function checkMatch(zone, item) {
        if (zone.querySelector('.draggable')) return; // å·²æœ‰ç­”æ¡ˆ

        const answer = zone.dataset.answer;
        const word = item.textContent;

        if (answer === word) {
            // æˆåŠŸ
            const placeholder = zone.querySelector('.placeholder');
            placeholder.style.display = 'none';

            const matchedItem = document.createElement('div');
            matchedItem.className = 'draggable matched';
            matchedItem.textContent = word;
            zone.appendChild(matchedItem);

            item.style.visibility = 'hidden'; // éš±è—åŸæœ¬çš„
            zone.style.borderColor = '#2E7D32';
        } else {
            // å¤±æ•—
            zone.style.backgroundColor = '#FFEBEE';
            setTimeout(() => {
                zone.style.backgroundColor = '#D7CCC8';
            }, 500);
        }
    }

    // å•Ÿå‹•éŠæˆ²
    initGame();

</script>

</body>
</html>
