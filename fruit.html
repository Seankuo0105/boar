<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>山豬接水果</title>
<style>
body {
    margin: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background-color: #cceeff;
    cursor: none;
}
#gameCanvas {
    display: block;
    background-color: #a2d5f2;
}
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const pigImg = new Image();
pigImg.src = 'pig.png';
const pigWidth = 80;
const pigHeight = 80;
let pigX = canvas.width/2 - pigWidth/2;
const pigY = canvas.height - pigHeight - 10;

const fruits = [];
const fruitEmojis = ['🍎','🍌','🍇','🍉','🍓'];
const fruitSize = 30;

let score = 0;
let lives = 3;
let gameRunning = false;

function spawnFruit(){
    const x = Math.random() * (canvas.width - fruitSize);
    const emoji = fruitEmojis[Math.floor(Math.random()*fruitEmojis.length)];
    fruits.push({x:x, y:-fruitSize, emoji:emoji});
}

function updateFruits(){
    for(let i=fruits.length-1;i>=0;i--){
        fruits[i].y += 4;
        // 撞到山豬
        if(fruits[i].y + fruitSize >= pigY &&
           fruits[i].x + fruitSize >= pigX &&
           fruits[i].x <= pigX + pigWidth){
            score++;
            fruits.splice(i,1);
        } else if(fruits[i].y > canvas.height){
            lives--;
            fruits.splice(i,1);
            if(lives <=0){
                gameRunning=false;
                alert(`遊戲結束! 分數: ${score}`);
                resetGame();
            }
        }
    }
}

function resetGame(){
    score=0;
    lives=3;
    fruits.length=0;
    pigX = canvas.width/2 - pigWidth/2;
}

function drawInfo(){
    // 標題與操作方式
    ctx.fillStyle='black';
    ctx.font='30px Arial';
    ctx.textAlign='left';
    ctx.fillText('山豬接水果',10,40);
    ctx.font='20px Arial';
    ctx.fillText('操作方式：滑鼠拖曳山豬接水果',10,70);

    // 分數與生命
    ctx.textAlign='right';
    ctx.fillText(`分數: ${score}`, canvas.width-10, 40);
    ctx.fillText(`生命: ${'❤️'.repeat(lives)}`, canvas.width-10, 70);
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    drawInfo();

    // 畫山豬
    ctx.drawImage(pigImg,pigX,pigY,pigWidth,pigHeight);

    // 畫水果
    ctx.font='30px Arial';
    for(const f of fruits){
        ctx.fillText(f.emoji,f.x,f.y);
    }

    if(gameRunning) requestAnimationFrame(draw);
}

function gameLoop(){
    if(!gameRunning) return;
    updateFruits();
}

// 滑鼠控制山豬
canvas.addEventListener('mousemove',(e)=>{
    const rect = canvas.getBoundingClientRect();
    pigX = e.clientX - rect.left - pigWidth/2;
    pigX = Math.max(0,Math.min(canvas.width-pigWidth,pigX));
});

// 空白鍵開始遊戲
document.addEventListener('keydown',(e)=>{
    if(e.code==='Space' && !gameRunning){
        gameRunning=true;
        resetGame();
        draw();
        setInterval(spawnFruit,1000);
        setInterval(gameLoop,20);
    }
});

// 預設畫面提示
ctx.fillStyle='black';
ctx.font='40px Arial';
ctx.textAlign='center';
ctx.fillText('山豬接水果', canvas.width/2, canvas.height/2 - 40);
ctx.font='20px Arial';
ctx.fillText('按空白鍵開始遊戲', canvas.width/2, canvas.height/2);

</script>
</body>
</html>

