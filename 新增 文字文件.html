<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>å±±è±¬æ¥æ°´æœ</title>
<style>
body {
    margin: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background-color: #cceeff;
    cursor: none;
}
#gameCanvas {
    display: block;
    background-color: #a2d5f2;
}
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const pigImg = new Image();
pigImg.src = 'pig.png';
const pigWidth = 80;
const pigHeight = 80;
let pigX = canvas.width/2 - pigWidth/2;
const pigY = canvas.height - pigHeight - 10;

const fruits = [];
const fruitEmojis = ['ğŸ','ğŸŒ','ğŸ‡','ğŸ‰','ğŸ“'];
const fruitSize = 30;

let score = 0;
let lives = 3;
let gameRunning = false;

function spawnFruit(){
    const x = Math.random() * (canvas.width - fruitSize);
    const emoji = fruitEmojis[Math.floor(Math.random()*fruitEmojis.length)];
    fruits.push({x:x, y:-fruitSize, emoji:emoji});
}

function updateFruits(){
    for(let i=fruits.length-1;i>=0;i--){
        fruits[i].y += 4;
        // æ’åˆ°å±±è±¬
        if(fruits[i].y + fruitSize >= pigY &&
           fruits[i].x + fruitSize >= pigX &&
           fruits[i].x <= pigX + pigWidth){
            score++;
            fruits.splice(i,1);
        } else if(fruits[i].y > canvas.height){
            lives--;
            fruits.splice(i,1);
            if(lives <=0){
                gameRunning=false;
                alert(`éŠæˆ²çµæŸ! åˆ†æ•¸: ${score}`);
                resetGame();
            }
        }
    }
}

function resetGame(){
    score=0;
    lives=3;
    fruits.length=0;
    pigX = canvas.width/2 - pigWidth/2;
}

function drawInfo(){
    // æ¨™é¡Œèˆ‡æ“ä½œæ–¹å¼
    ctx.fillStyle='black';
    ctx.font='30px Arial';
    ctx.textAlign='left';
    ctx.fillText('å±±è±¬æ¥æ°´æœ',10,40);
    ctx.font='20px Arial';
    ctx.fillText('æ“ä½œæ–¹å¼ï¼šæ»‘é¼ æ‹–æ›³å±±è±¬æ¥æ°´æœ',10,70);

    // åˆ†æ•¸èˆ‡ç”Ÿå‘½
    ctx.textAlign='right';
    ctx.fillText(`åˆ†æ•¸: ${score}`, canvas.width-10, 40);
    ctx.fillText(`ç”Ÿå‘½: ${'â¤ï¸'.repeat(lives)}`, canvas.width-10, 70);
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    drawInfo();

    // ç•«å±±è±¬
    ctx.drawImage(pigImg,pigX,pigY,pigWidth,pigHeight);

    // ç•«æ°´æœ
    ctx.font='30px Arial';
    for(const f of fruits){
        ctx.fillText(f.emoji,f.x,f.y);
    }

    if(gameRunning) requestAnimationFrame(draw);
}

function gameLoop(){
    if(!gameRunning) return;
    updateFruits();
}

// æ»‘é¼ æ§åˆ¶å±±è±¬
canvas.addEventListener('mousemove',(e)=>{
    const rect = canvas.getBoundingClientRect();
    pigX = e.clientX - rect.left - pigWidth/2;
    pigX = Math.max(0,Math.min(canvas.width-pigWidth,pigX));
});

// ç©ºç™½éµé–‹å§‹éŠæˆ²
document.addEventListener('keydown',(e)=>{
    if(e.code==='Space' && !gameRunning){
        gameRunning=true;
        resetGame();
        draw();
        setInterval(spawnFruit,1000);
        setInterval(gameLoop,20);
    }
});

// é è¨­ç•«é¢æç¤º
ctx.fillStyle='black';
ctx.font='40px Arial';
ctx.textAlign='center';
ctx.fillText('å±±è±¬æ¥æ°´æœ', canvas.width/2, canvas.height/2 - 40);
ctx.font='20px Arial';
ctx.fillText('æŒ‰ç©ºç™½éµé–‹å§‹éŠæˆ²', canvas.width/2, canvas.height/2);

</script>
</body>
</html>

